jQuery(document).ready(function($){let category_button=$('.section-category'),category_list=$('.category-list'),result_list=$('.result-list'),form_list=$('.form-list'),category_items=category_list.find('li'),input_category=$('input#category'),input_search=$('input#input-search');input_search.on('input',function(e){send_search_request('input');});input_search.on('blur',function(e){result_list.slideUp(300);});function send_search_request(target){let val=input_search.val();let category=input_category.val();if((val.length>=3&&target==='input')||target==='category'){$.ajax({url:ajax.url,method:'POST',dataType:'json',data:{action:'search_ajax',s:val,category:category},success:function(response){result_list.html(response);result_list.slideDown(300);},error:function(jqXHR,exception){if(jqXHR.status==404){alert('Requested page not found (404).');}else if(jqXHR.status==500){alert('Internal Server Error (500).');}else if(exception==='parsererror'){alert('Requested JSON parse failed.');}else if(exception==='timeout'){alert('Time out error.');}else if(exception==='abort'){alert('Ajax request aborted.');}}});}}
category_button.on('click',function(e){e.stopPropagation();if(category_button.hasClass('open')){hide_category_list();}else{show_category_list();}});category_items.on('click',function(e){e.stopPropagation();let current_category=$(e.currentTarget),name=current_category.attr('data-name');category_items.removeClass('selected');current_category.addClass('selected');category_button.find('.category-name').text(current_category.text());input_category.attr('value',name);send_search_request('category');hide_category_list();});$('body').on('click',function(e){let target=$(e.target);if(!target.is(category_button)||!target.is(category_items)){hide_category_list();}});function show_category_list(){category_button.addClass('open');result_list.slideUp(300,()=>{category_list.slideDown(300);});}
function hide_category_list(){category_button.removeClass('open');category_list.slideUp(300);}});